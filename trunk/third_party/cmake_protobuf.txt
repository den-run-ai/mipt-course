# Copyright (c) 2011 Timur Iskhodzhanov and MIPT students. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

cmake_minimum_required(VERSION 2.6)

project(protobuf)

# TODO(dimankuskov) Remove references to ${prj_src}
include_directories( ${prj_src}/third_party/protobuf/src)
link_directories(${prj_src}/third_party/protobuf/src/.libs/)

add_custom_target(protobuf 
  ALL 
  DEPENDS ${prj_src}/third_party/protobuf/src/.libs/libprotobuf.so
)

add_custom_command(
  OUTPUT  ${prj_src}/third_party/protobuf/src/.libs/libprotobuf.so
  COMMAND ./autogen.sh
  COMMAND ./configure
  COMMAND make -j3
# TODO(dimankuskov) Pass some arguments to above make command 
#               from project make command, like -j, -s or -d 
  WORKING_DIRECTORY ${prj_src}/third_party/protobuf 
  COMMENT google/protobuf
)

 
